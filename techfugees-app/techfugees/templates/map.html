{% block content %}
<form method="POST" action="" enctype="multipart/form-data">
    {{ form.hidden_tag() }}
    <legend> Search </legend>
    <fieldset class=form-group>
        <div class=form-group>
            {{ form.type_of_building.label(class="form-control-label") }}

            {% if form.type_of_building.errors %}
            {{ form.type_of_building(class="form-control form-control-lg is-invalid") }}
            <div class="invalid-feedback">
                {% for error in form.type_of_building.errors %}
                <span>{{ error }}</span>
                {% endfor %}
            </div>
            {% else %}
            {{ form.type_of_building(class="form-control form-control-lg") }}
            {% endif %}
        </div>
    </fieldset>

    <div class=form-group>
        {{ form.submit(class="btn btn-outline-info") }}
    </div>
</form>

<div id="map" style="height: 100%"></div>
{% endblock %}
<script src="http://maps.google.com/maps/api/js?key=AIzaSyBgDy3WJoB5prBHOZBhSEwWZC_GQp04s9w"></script>
<script type="text/javascript">
    let data = {{mymap|safe}}
    function techMap() {
        let latitude = parseFloat("43.663908");
        let longitude = parseFloat("-79.387670");
        let latlngPos = new google.maps.LatLng(latitude, longitude);
        let myOptions = {
            zoom: 10,
            center: latlngPos,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        let map = new google.maps.Map(document.getElementById("map"), myOptions);
        data.forEach(function(p) {
            let point = new google.maps.LatLng(p.lat, p.lng);
            let marker = new google.maps.Marker({position: point,
                map: map,
                title: p.title
            });
        })
    }
    techMap()
</script>